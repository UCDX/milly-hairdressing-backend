# Documentation REST API

## Index.
* [General information](#general-information)
* [Users](#users)
  * [Sign up](#sign-up)
  * [Log in](#log-in)
  * [Create Reservation](#create-reservation)
* [Hairdressing salon services](#hairdressing-salon-services)
  * [Add service](#add-service)
  * [Get all services](#get-all-services)
* [Reservations](#reservations)
  * [Get blocked time](#get-blocked-time)

## General information

### General codes

* 0: Success.

#### Error codes

This kind of codes are negative numbers. They represents errors with the data provided by the client.

* -1: Params are not corrects.
* -2: Authentication is missing.
* -3: Error while decoding token.

### Response data structure

```json
{
  "code": 0,
  "messages": [ ],
  "data": { }
}
```

* `code`: The exit code of the process. Each endpoint could has their respective exit codes, see the
**Codes** section in order to know the possible exits codes and their respective message.
* `messages`: A message array to help the programmer to identify easier what happened with the process.
* `data`: The data requested, or the data returned **when the execution was correct**.

### Mandatory headers
* **Content-Type**: application/json
* **Authorization**: [JWT generated by a call to the login endpoint]

Authorization header is not always required but it is at most of endpoints. Where it is required will be
mentioned on headers section of the endpoint description. This header is used to authenticate the user
that requests an endpoint.

## Users

### Sign up

#### Headers

Not more than the mandatories.

#### Method

POST

#### Endpoint

`/api/users/signup`

#### Parameters

* `user_type_id`: int. Valid options:
  * `1`: for 'admin' user. 
  * `2`: for 'hairdresser' user.
  * `3`: for 'customer' user.
* `firstname`: string. Max length: 64 characters.
* `lastname`: string. Max length: 64 characters.
* `email`: string. Max length: 100 characters.
* `phone_number`: string. Optional parameter. Max length: 15 characters (numbers).
* `passwd`: string.

#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "id": 21,
    "firstname": "Jhon",
    "lastname": "customer",
    "email": "jhon_customer@gmail.com",
    "phone_number": "9911223344",
    "is_active": 1,
    "user_type_id": 3,
    "type_name": "Cliente",
    "type_code": "customer",
    "session_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyMX0.3qxyQGOJACltjdakaULv2-IPKdSX0B7ZOB6yW9wUOrk"
  }
}
```

#### Codes

* 1: Email already registered.

### Log in

#### Headers

Not more than the mandatories.

#### Method

POST

#### Endpoint

`/api/users/login`

#### Parameters

* `email`: string. Max length: 100 characters.
* `passwd`: string.

#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "id": 21,
    "firstname": "Jhon",
    "lastname": "customer",
    "email": "jhon_customer@gmail.com",
    "phone_number": "9911223344",
    "is_active": 1,
    "user_type_id": 3,
    "type_name": "Cliente",
    "type_code": "customer",
    "session_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyMX0.3qxyQGOJACltjdakaULv2-IPKdSX0B7ZOB6yW9wUOrk"
  }
}
```

#### Codes

* 1: Invalid credentials.

### Create Reservation

#### Headers

* `Authorization`

#### Method

POST

#### Endpoint

`/api/users/create-reservation`

#### Parameters

* `service_id`: int
* `reservation_date`: string. Format: 'YYYY-MM-DD'
* `start_time`: string. Format: 'HH:MM:SS'


#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "id": 11,
    "service_id": 1,
    "reservation_date": "2021-11-22",
    "start_time": "15:00:00",
    "end_time": "17:00:00"
  }
}
```
#### Codes

* 1: Schedule conflict.

## Hairdressing salon services

### Add service

#### Headers

* `Authorization`

#### Method

POST

#### Endpoint

`/api/services/add`

#### Parameters

* `service_name`: string. Max length: 100 characters.
* `cost`: float. 
* `service_description`: string.
* `short_description`: string. Max length: 100 characters.
* `service_duration`: int.

#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "id": 14,
    "service_name": "Manicure Express",
    "cost": 60,
    "service_description": "Manicure Express",
    "short_description": "Manicure Express",
    "service_duration": 1,
    "is_active": 1
  }
}
```

#### Codes

* 1: Forbidden. User unauthorized.


### Get all services

#### Headers

Not more than the mandatories.

#### Method

GET

#### Endpoint

`/api/services/get-all`

#### Parameters

None

#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "total_records": 2,
    "services": [
      {
        "id": 20,
        "service_name": "Corte de cabello para Caballero",
        "cost": 60,
        "service_description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus quis vulputate ex. Cras id ipsum viverra, fermentum ipsum sed, lacinia ex. Nunc nec neque congue, consectetur massa sit amet, interdum augue. Fusce rutrum sapien vitae mauris aliquet commodo. Integer vel ipsum vitae nisl porttitor lacinia id tincidunt est. ",
        "short_description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "service_duration": 1,
        "is_active": 1
      },
      {
        "id": 21,
        "service_name": "Corte de cabello para Dama",
        "cost": 100,
        "service_description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus quis vulputate ex. Cras id ipsum viverra, fermentum ipsum sed, lacinia ex. Nunc nec neque congue, consectetur massa sit amet, interdum augue. Fusce rutrum sapien vitae mauris aliquet commodo. Integer vel ipsum vitae nisl porttitor lacinia id tincidunt est. ",
        "short_description": "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "service_duration": 1,
        "is_active": 1
      }
    ]
  }
}
```

#### Codes

None

## Reservations

### Get blocked time

#### Headers

None

#### Method

GET

#### Endpoint

`/api/reservations/blocked-time`

#### Parameters

* `date`: string. Format: 'YYYY-MM-DD'

#### Response example

```json
{
  "code": 0,
  "messages": [
    "Done"
  ],
  "data": {
    "reservations": [
      {
        "start_time": "10:00:00",
        "end_time": "12:00:00"
      },
      {
        "start_time": "12:00:00",
        "end_time": "13:00:00"
      },
      {
        "start_time": "13:00:00",
        "end_time": "16:00:00"
      }
    ]
  }
}
```

#### Codes

None
